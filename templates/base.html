{% load staticfiles %}

<!DOCTYPE html>
<html lang="en">

<link rel="icon" type="image/png" href="{% static "favicon.png" %}">

<head>
    <meta charset="utf-8">
    <title>Realtime Lupus 7</title>
    <link rel="stylesheet" href="{% static "reset.css" %}" />
    <link rel="stylesheet" href="{% static "text.css" %}" />
    <link rel="stylesheet" href="{% static "960.css" %}" />
    <link rel="stylesheet" href="{% static "lupus.css" %}" />
    <link rel="stylesheet" href="{% static "fish.css" %}" />
    
    <!--<link href='http://fonts.googleapis.com/css?family=Ubuntu:400,700,400italic' rel='stylesheet' type='text/css'>-->
    
    <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <script src="{% static "script.js" %}"></script>
    <script src="{% static "jquery-1.11.0.min.js" %}"></script>
    <script src="{% static "fish.js" %}"></script>
</head>

<body>
    
    <div id="header-background">
            <div id="header-background-upper"></div>
            <div id="header-background-lower"></div>
    </div>
    
    <div class="container_16">
            <header id="header" class="grid_16">
                    <!--<img id="logo" src="{% static "logo.png" %}"/>-->
                    <img id="logo" src="{% static "logo.svg" %}" onerror="this.src='{% static "logo.png" %}'; this.onerror=null;">
                    <div id="header-upper">
                        <span id="login">
                            <div>
                            {% if user.is_authenticated %}
                                <a href="{% url 'logout' %}">Logout</a>
                            {% else %}
                                <a href="{% url 'login' %}">Login</a>
                                -
                                <a href="{% url 'signup' %}">Registrati</a>
                            {% endif %}
                            </div>
                            {% if user.is_authenticated %}
                                <div class="username">
                                    Sei loggato come {{ user.username }} ({{ user.first_name }} {{ user.last_name }})
                                </div>
                            {% endif %}
                            {% if user.is_master and player %}
                                <div class="point-of-view">
                                    Punto di vista di {{ player.full_name }}
                                </div>
                            {% endif %}
                        </span>
                        <ul>
                            <li><a href="{% url 'home' %}">Home</a></li>
                            {% if game and player %}
                                <li><a href="{% url 'game:status' game_name=game.name  %}">Stato del villaggio</a></li>
                                <li><a href="{% url 'game:announcements' game_name=game.name %}">Annunci dei GM</a></li>
                            {% endif %}
                        </ul>
                    </div>
                    <div id="header-lower">
                        {% if latest_announcement %}
                            <strong>{{ latest_announcement.timestamp|date:"d/m/Y H:i" }}</strong> {{ latest_announcement.text|truncatechars:125 }}
                        {% endif %}
                    </div>
            </header>
        
            <div class="clear"></div>
        
        {% if classified %}
            <div class="grid_16">
                <div class="security-banner">
                        <img id="visibility-indicator" src="{% static "classified.png" %}" />
                        Questa pagina contiene informazioni riservate. Accertati di essere da sol{{ user.profile.oa }}.
                </div>
            </div>
        {% endif %}
        
        <div class="clear vertical-space"></div>
        
        <aside class="grid_3">
                {% if game is not None and user.is_authenticated %}
                    <div class="nav-menu">
                        <h1>{{ game.description }}</h1>
                        <ul>
                        {% if player is None and not is_master and current_turn.phase == CREATION %}
                            <li><a href="{% url 'game:join' game_name=game.name %}">Unisciti al villaggio</a></li>
                        {% endif %}
                        {% if player is not None and current_turn.phase == CREATION %}
                            <li><a href="{% url 'game:leave' game_name=game.name %}">Abbandona il villaggio</a></li>
                        {% endif %}
                        {% if player and current_turn.phase != CREATION %}
                            <li><a href="{% url 'game:personalinfo' game_name=game.name %}">Informazioni personali</a></li>
                            <li><a href="{% url 'game:vote' game_name=game.name %}">Votazione per il rogo</a></li>
                            <li><a href="{% url 'game:elect' game_name=game.name %}">Elezione del Sindaco</a></li>
                            <li><a href="{% url 'game:usepower' game_name=game.name %}">Potere notturno</a></li>
                            {% if player.is_mayor and current_turn.phase != CREATION %}
                                <li><a href="{% url 'game:appoint' game_name=game.name %}">Designa successore</a></li>
                            {% endif %}
                            <li><a href="{% url 'game:comment' game_name=game.name %}">Commenti alla partita</a></li>
                        {% endif %}
                    </ul>
                    </div>
                {% endif %}

                <div class="nav-menu">
                    <h1>Informazioni</h1>
                    <ul>
                        <li><a href="{% url 'ruleset' %}">Regolamento</a></li>
                        <li><a href="{% url 'prototypes' %}">Prototipi</a></li>
                        {% if game and player %}
                            <li><a href="{% url 'game:contacts' game_name=game.name %}">Contatti</a></li>
                        {% endif %}
                    <li><a href="{% url 'credits' %}">Riconoscimenti</a></li>
                    <li><a href="{% url 'trailer' %}">Trailer</a></li>
                </ul>
                </div>
                {% comment %}
                    <!--TODO: Decidere come mostrare il menÃ¹ Dopo-partita.-->
                    {% if current_turn.phase == DAY or current_turn.phase == NIGHT or user.is_staff %}
                    {# This menu is shown when game is over. When the game finishes, only staff can see it until DAY or NIGHT #}
                    <div class="nav-menu">
                            <h1>Dopo-partita</h1>
                            <ul>
                                    <li><a href="{% url 'game:adminstatus' game_name=game.name %}">Tutte le informazioni</a></li>
                            </ul>
                    </div>
                    {% endif %}
                {% endcomment %}

            {% if user.is_authenticated %}
                <div class="nav-menu">
                    <h1>Area personale</h1>
                    <ul>
                        <li><a href="{% url 'password_change' %}">Cambia password</a></li>
                        <li><a href="{% url 'creategame' %}">Crea nuovo villaggio</a></li>
                    </ul>
            {% endif %}

            {% if is_master %}
                <div class="nav-menu">
                    <h1>GM</h1>
                    <ul>
                        {% if current_turn.phase == CREATION %}
                            <li><a href="{% url 'game:setup' game_name=game.name %}">Setup iniziale</a></li>
                        {% endif %}
                        <li><a href="{% url 'game:adminstatus' game_name=game.name %}">Tutte le informazioni</a></li>
                        <li><a href="{% url 'game:pointofview' game_name=game.name %}">Punto di vista</a></li>
                        <li><a href="{% url 'game:settings' game_name=game.name %}">Impostazioni</a></li>
                        <li><a href="{% url 'game:restart' game_name=game.name %}">Ricomincia partita</a></li>
                    </ul>
                </div>
            {% endif %}

            {% if user.is_staff %}
                <div class="nav-menu">
                    <h1>Admin</h1>
                    <ul>
                        <li><a href="{% url 'admin:index' %}">Admin: Index</a></li>
                        <li><a href="{% url 'admin:game_player_changelist' %}">Admin: Players</a></li>
                        <li><a href="{% url 'admin:game_commandevent_changelist' %}">Admin: CommandEvents</a></li>
                        <li><a href="{% url 'admin:game_comment_changelist' %}">Admin: Comments</a></li>
                        <li><a href="{% url 'admin:game_pagerequest_changelist' %}">Admin: PageRequests</a></li>
                    </ul>
                </div>
            {% endif %}

            </aside>

            {% block content %}{% endblock %}

            <div class="clear"></div>
    </div>
    
    
    
    <script>
      fish_images = [
          "{% static 'fishes/fish1.svg' %}",
          "{% static 'fishes/fish2.svg' %}",
          "{% static 'fishes/fish3.svg' %}",
          "{% static 'fishes/fish4.svg' %}",
      ];
      //create_fishes_by_density(0.00003);
    </script>
</body>
</html>
